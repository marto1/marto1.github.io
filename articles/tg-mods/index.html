<!DOCTYPE html>
<html lang='en-US'><head><link rel='shortcut icon' href='/static/favicon.ico' /><meta name='yandex-verification' content='171a191b7370e956' /><meta charset='utf-8' /><meta name='keywords' content='hacks, telegram, cli, command line' /><meta name='description' content='telegram-cli mods. 2018-03-30' /><meta name='author' content='Martin Gergov' /><link type='text/css' rel='stylesheet' href='/static/main.css' /><script src='/static/jquery.min.js' type='text/javascript'></script><script type='text/javascript' src='/static/menuswitch.js'></script><script type='text/javascript' src='https://pastebin.com/raw/GHJBJQR7'></script><title>telegram-cli mods | Martin's windtrap</title></head><body><div class='page'><span style='display:none;' id='_context'> <a href='/'>Home</a> <a href='/log'>Log</a> <a href='/about'>About</a>&nbsp; </span><h2 class='heading'><a onclick='switch_menu($("#_theline"), $("#_context"));' id='_themenu'>[≣]</a><span id='_theline'>[2018-03-30]hacks:telegram-cli mods</span></h2><h2 id='experiment_with_telegram' class='paraheading'>Experiment with telegram</h2><p class='reading'>I'm on my second week of trying out the Telegram
	       service. It's been going on quite well with the
	       exception of a few hours downtime this week. The
	       official explanation is that the service is growing so
	       fast they could barely keep up and a major data center
	       had a power outage. It sounds resonable. Feature wise
	       it's pretty much 1:1 mimic of fb messenger. This means
	       beside sending text - webpage previews, sending photos,
	       videos, files. Still no webm stream support! I think fb
	       converts them to mp4 as soon as they are shared. The
	       more interesting part is the exposed APIs and open
	       source clients. This gives people like me a playground
	       for experimentation and a promise of much more
	       automated chatting. Example is forwarding media to
	       multiple groups - in fb I would have to click
	       around. It's shit. Here you have a way to make your own
	       script and use it to send to all those groups with a
	       single command. Talking specifically about <a href='https://github.com/vysheng/tg'>tg</a> here. So
	       far it has been really stable even with me messing
	       around with it.</p><h2 id='bugs' class='paraheading'>Bugs</h2><p class='reading'>First few days I noticed a bug while trying to
	       change my profile pic. In the tgl library in queries.c
	       in send_avatar_end function there is </p><p class='quotebash'>out_int (CODE_photos_upload_profile_photo);</p><p class='reading'> and it's written twice. Comment one of the lines
	       and you'll be able to change the photo.</p><h2 id='modifications' class='paraheading'>Modifications</h2><p class='reading'> It seems tg has some scripting abilities - python
	       and lua. While this is great I couldn't find how to
	       make script changes be loaded on-the-fly and not only
	       in the beginning not to mention language
	       independence. So my plan was to make it possible to
	       call a script from the cli and pipe its output back to
	       the cli. Kinda how WSGI works. With the help of execv
	       there is now the "!" command. Say you want to turn the
	       string 'aaa' into 'a a a' You could call:</p><p class='quotebash'>! space my_group aaa</p><p class='reading'>where space is a bash script/C program/anything
	       callable and aaa is the argument. I still can't figure
	       out variable arguments, but I'll add them soon I
	       hope. You can get the project <a href='https://github.com/marto1/tg-mods'>here</a>.</p><div class='footer'><p class='reading'>© Copyright 2018 Martin Gergov. Content: <a href='http://www.creativecommons.org/licenses/by/2.5/'>Creative Commons</a></p><p class='reading'>We can talk on <a href='mailto:martingergov1@gmail.com'>mail</a>, <a href='https://twitter.com/marto1_'>twitter</a> (in that order or sharks with missile launchers will get you).<p class='reading'>Made with <a href='http://flask.pocoo.org/'>flask</a> that has a <a href='http://www.sbcl.org/'>lisp</a>.</p></p></div></div></body></html>